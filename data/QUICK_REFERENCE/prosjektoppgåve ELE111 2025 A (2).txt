--- Page 1 ---
ELE111 SemesteroppgÃ¥ve 
  1 
 
ProsjektoppgÃ¥ve i ELE111 2025 
Innleiing 
Denne oppgÃ¥va er ein del av vurderingsgrunnlaget i ELE111. Det blir gitt karakter pÃ¥ oppgÃ¥va, 
A-F. OppgÃ¥va tel 40% av karakteren i emnet. 
Det er planen at du skal arbeida med oppgÃ¥va gjennom heile semesteret .  
OppgÃ¥veformulering                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
Det skal lagast eit design for eit kommunikasjonssystem, der to D2-155-kort skal kunne senda 
meldingar til kvarandre. Eit kort skal vera sendar, eit anna mottakar. Kommunikasjonen skal 
fÃ¸lgja RS-232-protokollen. Det skal skrivast VHDL-kode for sendar og mottakar. Det bÃ¸r lagast 
eit felles Quartus-prosjekt som inneheld bÃ¥de sendar og mottakar.  
Det er ein mÃ¥l at koden frÃ¥ dette prosjektet skal kunne brukast vidare i ELE113. Det skal derfor 
lagast ein entity for sendar og ein for mottakar som har ein veldefinert grensesnitt (portar). 
Mal for enteties  for sendar og mottakar er gitt i Figur 4 og Figur 5. 
 
Innlevering 
OppgÃ¥va skal leverast pÃ¥ Wiseflow. Fristen for innlevering Blir kunngjort pÃ¥ Wiseflow og pÃ¥ 
Canvas. 
Det skal leverast: 
â€¢ Komplett(e) Quartusprosjekt som zip-fil. 
â€¢ Eit pdf-dokument med 
o Forklaring og beskrivelse av det leverte systemet 
o Test-rapport med utklipp frÃ¥ Modelsim og SignalTap, og evaluering av 
testresultat. 
o Test-rapport frÃ¥ testing av system pÃ¥ kortet. 
Ved karaktersetjinga vil bÃ¥de rapport og VHDLâ€”kode telja med.

--- Page 2 ---
ELE111 SemesteroppgÃ¥ve 
  2 
System-oversikt. 
RS-232-protokollen 
RS-232 er ein standard for kommunikasjon mellom to punkt, over relativt kort avstand og lÃ¥g til 
middels datarate. Den blir brukt til f. eks 
â€¢ PC <-> skriver 
â€¢ PC <-> modem 
â€¢ Server <-> terminal 
â€¢ PC <â€“> mikrokontroller. 
RS-232 bruker ein par-kabel (to leiarar), gjerne tvinna parkabel. 
Datarater frÃ¥ 75 bit/s til 256000 bit/s 
RS-232 er erstatta av USB i mange samanhengar. 
RS-232 blir brukt til punkt-til punkt-kommunikasjon, slik at det er  ein sendar og ein mottakar. 
Sendaren set opp spenning mellom kablane i trÃ¥dparet, mottakaren mÃ¥ler spenninga.  
â€º Ved bruk av RS-232 mÃ¥ sendar og mottakar vera einige om en del reglar for 
kommunikasjonen. Vi mÃ¥ bestemma: 
â€º Tal pÃ¥ databit i kvar melding â€“ 5-8 bit 
â€º Synkroniseringsbit â€“ 1 eller 2 stoppbit 
â€º Paritetsbit, odde, like eller ingen paritet. 
â€º Baud-rate 
 
Figur 1  RS-232C Seriell overfÃ¸ring av et 8-bits signal (kilde: Rapid) 
Figur 1 viser tidsforlÃ¸p for spenninga pÃ¥ ei RS232-linje under sending av ei melding. 
Spenninga ligg hÃ¸g nÃ¥r linja ikkje sender melding. Ei melding startar med eit startbit, det er 
alltid '0'. SÃ¥ kjem databit, sÃ¥ mange som det er bestemt pÃ¥ fÃ¸rehand. I Figur 1 er det 8 bit 
data, det er ikkje brukt paritet. Dersom det blir brukt paritet, kjem paritetsbitet etter siste 
databit. Melding blir avslutta av eit eller to stoppbit. Stoppbit er alltid '1'.  
I RS-232 kan vi ha frÃ¥ 5 til 8 bit pr melding. Linja ligg med hÃ¸g spenning nÃ¥r han er ledig. 
(HÃ¸g spenning = Vcc) 
0 0 0 0 1 0 1 0
Start
Bit
0 1 2 3 4 5 6 7 Stop
BitData Bit number
Mark (1)
Space (0)
ASCII â€œPâ€ = 0x50
Time
LSB MSB

--- Page 3 ---
ELE111 SemesteroppgÃ¥ve 
  3 
data_ut 
BaudEnable 
FÃ¸r databit blir sendt, sender vi startbitet, det er alltid '0'  (LÃ¥g spening, 0V). Etter startbitet 
kjem databit, sÃ¥ mange vi har bestemt,  
'1' = hÃ¸g spenning, '0' = lÃ¥g spenning 
Til slutt kjem eit eller to stop-bit, alltid '1'. Dersom vi har med paritet, kjem paritetsbitet 
mellom siste data-bit og stop-bitet. 
 
 
Baud-rate 
Baudrate er antall symbol overfÃ¸rt pr sekund. I RS-232 bruker vi eit symbol pr databit, men i 
tillegg mÃ¥ vi bruka nokre symbol til Ã¥ senda startbit, stopp-bit og eventuell paritet. Dersom baud-
raten er ğ‘…ğµ
 ğ‘ ğ‘¦ğ‘šğ‘ğ‘œğ‘™
ğ‘ ğ‘’ğ‘˜ğ‘¢ğ‘›ğ‘‘  er symbol-perioden ğ‘‡ğµ =
1
ğ‘…ğµ
 
BÃ¥de sendar og mottakar mÃ¥ ha ein tilstandsmaskin for Ã¥ generera baud -raten. 
Tilstandsmaskinen skal senda ut ein puls, BaudEnable, ein gong pr baud -periode, for den 
baudraten som er vald.  
I sendaren bestemmer BaudEnable at neste bit skal sendast til utgangen, dvs startbitet startar pÃ¥ 
den fÃ¸rste BaudEnable-pulsen, fÃ¸rste databit pÃ¥ den neste BaudEnable-pulsen, og sÃ¥ eit nytt bit 
for kvar BaudEnable-puls til heile meldinga er sendt. Eksempel pÃ¥ BaudEnable og data-ut er vist i 
Figur 2 
 
 
 
 
 
 
 
               
               
               
               
Figur 2 Data-ut-signal og BaudEnable i sender 
  
databit 
startbit stoppbit 
databit

--- Page 4 ---
ELE111 SemesteroppgÃ¥ve 
  4 
data_inn 
BaudEnable 
For mottakar blir det litt ulikt. Mottakar mÃ¥ lesa av data-inn kontinuerleg. Data-inn ligg hÃ¸g sÃ¥ 
lenge ingenting blir sendt. Ei melding startar alltid med eit startbit som er '0', sÃ¥ nÃ¥r mottakaren 
oppdagar ein fallande flanke pÃ¥ inn-data, veit vi at vi har mottatt startbitet, og ei melding er 
undervegs. Denne fallande flanken i starten av start-bitet er signalet til Ã¥ setja i gang baud-
generatoren pÃ¥ mottakaren. Baud-generatoren skal gi ein BaudEnable-puls i kvar baud-periode, 
men i mottakaren skal denne koma midt i baud-perioden, ikkje i starten. Dette er fordi 
BaudEnable-pulsen fortel mottakaren nÃ¥r det er best Ã¥ lesa av verdien pÃ¥ det bitet vi har mottatt, 
og det er mest stabilt midt i symbolperioden. Dvs vi kan ha ein BaudEnable -puls ein halv baud-
periode etter at vi ha detektert starten pÃ¥ startbitet, og sÃ¥ neste puls ein baud-periode etterpÃ¥. 
Figur 3 viser tidsdiagram med data-inn-signal og BaudEnable. 
 
 
 
 
 
 
 
               
               
               
Figur 3 Data-inn-signal og BaudEnable i mottakar 
 
 
  
startbit stoppbit 
databit

--- Page 5 ---
ELE111 SemesteroppgÃ¥ve 
  5 
Sendar og mottakar skal kunne konfigurerast til eit utval standard datarater for RS-232. i tillegg 
bÃ¸r vi kunne ha datarate 1 Mbaud/sek. Det blir enklare Ã¥ bruka Modelsim og SignalTap med 
denne hÃ¸ge dataraten. 
Koden for sendar og mottakar skal vera mest mogleg generell, og kunne gjenbrukast i ELE113. 
Entity for sendar og mottakar skal derfor og innhalda kode eller komponent for Ã¥ generera 
baudrate.   
Baudrate for sendar og mottakar skal velgast ved ein 16-bit input, baud_rate_divider. 
Denne skal innhalda eit binÃ¦rtal som gir baud-perioden (TB) i talet pÃ¥ klokkeperiodar. Baud-
perioden TB i klokkeperioder for ein gitt datarate RB finn vi ved: 
ğ‘‡ğµ = 50 000 000
ğ‘…ğµ
 ğ‘˜ğ‘™ğ‘œğ‘˜ğ‘˜ğ‘’ğ‘ğ‘’ğ‘Ÿğ‘–ğ‘œğ‘‘ğ‘ğ‘Ÿ. 
 
Vi har ikkje nok svitsjar pÃ¥ DE2-kortet til Ã¥ setja baud_rate_divider direkte. Du mÃ¥ derfor 
legga kode eller komponent for Ã¥ setja rett baud_rate_divider for eit utval baud-rater ved 
hjelp av SW(16 downto 14).  
 
Baudrater og forslag til SW-setting er vist i Tabell 1 
 
Tabell 1 Baud-rater som skal brukast i systemet, og forslag til SW-innstilling 
 SW(16 downto 14) Baudrate 
0 000 4800 
1 001 9600 
2 010 19200 
3 011 34800 
4 100 57600 
5 101 74880 
6 110 115200 
7 111 1 MHz

--- Page 6 ---
ELE111 SemesteroppgÃ¥ve 
  6 
Samankopling 
 
Vi bruker den generelle kontakten EX_IO til Ã¥ kopla saman to DE2-115-kort.  
EX_IO-kontakten har 7 pinnar vi kan bruka til ulike ting. Dei er nummerert frÃ¥ 1 til 7 pÃ¥ kortet, 
men nÃ¥r vi definerer denne som ein port i VHDL, bruker vi nummerering frÃ¥ 0 til 35  
EX_IO : inout std_logic_vector(6 downto 0); 
 
EX_IO-porten kan deklarereast som inout. EX_IO-pinne 12 er fast jord- og vi bÃ¸r kopla saman 
EX_IO-pinne 12 pÃ¥ to kort for at vi skal ha felles jord-potensiale, og unngÃ¥ spenningsforskjell 
mellom sendar og mottakar. 
 
Bruk f. eks EX_IO(0) (EX_IO-pinne 1 pÃ¥ kortet) som data-ut pÃ¥ sendar, og EX_IO(6)  som data-
inn pÃ¥ mottakar. NÃ¥r inngangsdelen av EX_IO(6) denne blir brukt til Ã¥ ta i mot data i 
mottakaren, mÃ¥ utgangsdelen av EX_IO(6) bli sett i tri-state ('Z') 
 
EX_IO(6) <='Z'; 
data_inn <= EX_IO(6); 
 
NÃ¥r vi bruker ulike EX_IO-pinner til sendar og mottakar, kan vi testa systemet pÃ¥ eit kort ved Ã¥ 
kopla sende- og mottakarpinnane saman.

--- Page 7 ---
ELE111 SemesteroppgÃ¥ve 
  7 
  
 
Entity for sendar 
 
entity sender is 
    port( 
        clk : in std_logic;  
        rst_n : in std_logic;  
        startPuls : in std_logic;  
        baud_rate_divider : in std_logic_vector(15 downto 0);  
        dataIn : in std_logic_vector(7 downto 0);  
        txReady : out std_logic;   
        dataOut : out std_logic  
    ); 
end entity sender; 
 
 
Figur 4 Entity for sendar. 
Koden for sendar skal innhalda ein entity som vist i Figur 4. Avhengig av korleis du vel Ã¥ realisera 
sendaren, vil denne entityen bli ein komponent i topp-nivÃ¥-entiteten  for sendaren. 
Forklaring til portane: 
clk : in std_logic; -- systemklokke 
rst_n : in std_logic; -- reset, aktiv lÃ¥g 
startPuls : in std_logic; --puls som startar                    
sending av 8 bit med data 
baud_rate_divider : in std_logic_vector(15 downto 0);  
-- Baud-periode i antall (50 MHz) klokkeperiodar  
dataIn : in std_logic_vector(7 downto 0);  
-- 8 bit med data som skal overfÃ¸rast i ei 
melding 
txReady : out std_logic;  -- NÃ¥r txReady = '1' ventar 
sendar pÃ¥ ny sendEnable for Ã¥ starta sending av 
nye data. 
dataOut : out std_logic -- serielle data , skal koplast 
mot EX_IO-port

--- Page 8 ---
ELE111 SemesteroppgÃ¥ve 
  8 
Entity for mottakar. 
 
entity mottaker is 
  port( 
    clk         : in  std_logic; 
    rst_n       : in  std_logic; 
    dataInn     : in  std_logic; 
    baudRateDivider : in std_logic_vector(15 downto 0); 
    error       : out std_logic;  
    dataValidUt : out std_logic;  
    dataUt      : out std_logic_vector(7 downto 0)); 
end entity mottaker; 
 
 
Figur 5 Entity for mottakar 
Koden for mottakar skal innhalda ein entity som vist i Figur 5. Avhengig av korleis du vel Ã¥ 
realisera mottakaren, vil denne entityen bli ein komponent i topp-nivÃ¥-entiteten  for mottakaren. 
Forklaring til portane: 
clk         : in  std_logic; -- systemklokke 
rst_n       : in  std_logic; -- reset aktiv lÃ¥g 
dataInn     : in  std_logic; -- Serielle data inn 
baudRateDivider : in std_logic_vector(15 downto 0);  
-- Baud-periode i antall (50 MHz) klokkeperiodar 
error       : out std_logic; -- flag som er hÃ¸g om 
mottatt data ikkje er gyldig RS-232-data. 
dataValidUt : out std_logic; -- hÃ¸g nÃ¥r feilfrie data 
er mottatt og tilgjengeleg i dataUt 
dataUt      : out std_logic_vector(7 downto 0) -- 8 bit 
mottatt data  
 
 
Dersom du Ã¸nskjer Ã¥ gjera koden meir fleksibel, f. eks er det tillatt Ã¥ kunne konfigurera 
RSR-2-parameter som talet pÃ¥ bit og paritet gjennom bruk av generics eller 
kontrollsignal i entity for sender og mottakar.

--- Page 9 ---
ELE111 SemesteroppgÃ¥ve 
  9 
Levering 
I dette kapittelet er det sett opp kva som skal med i systemet som skal utviklast. For Ã¥ fÃ¥ topp-
karakter mÃ¥ alle element med i leveringa. For Ã¥ fÃ¥ bestÃ¥tt mÃ¥ minimum punkt 1a, 1f, 2, 3, 4a, 5a, 
6a og 7a leverast. Minimumskrava er merka med blÃ¥ farge. Det er lov Ã¥ levera kode som ikkje 
fungerer. 
1. Prosjektrapport som beskriver systemet 
a. System-beskrivelse pÃ¥ blokk-nivÃ¥ 
Rapporten skal beskriva systemet som er laga, eller som var tenkt lagd. 
Dersom ikkje alt fungerer, skal rapporten dokumentera kva som ikkje 
fungerer, og gjerne med forslag til forbedringar 
b. Test-rapport frÃ¥ testing med eit kort i loop 
c. Test-rapport frÃ¥ testing  kort mot kort 
d. Test-rapport frÃ¥ Modelsim-simulering 
e. Test-rapport frÃ¥ SignalTap-testing. 
f. Referanseliste.  Referansar kan skrivast  i ein  godkjend standard, til 
dÃ¸mes  standarden IEEE  Ein  god hugseregel er at kvar gong ein kjem 
med ein pÃ¥stand skal ein ha ein referanse. 
Dersom du hentar kode frÃ¥ andre, eller bruker kode du har skrive sjÃ¸lv i 
andre oppgÃ¥ver, skal det med ein referanse. 
2. VHDL-kode for sendar 
Sendar skal kunne senda data over EX_IO(0) som samsvarar med RS232-protokollen. 
Koden skal innehalda entity for sendar som vist i Figur 4.  Koden skal som minimum 
handtera meldingar med 8 bit, ingen paritet.  
Det er tillat Ã¥ laga kode som kan konfigurerast med 5-8 bit pr melding og med eller utan 
paritet, ved hjelp av gener ics eller kontrollsignal 
3. VHDL-kode for mottakar 
Mottakar skal kunne ta imot data over EX_IO(6) som samsvarar med RS232-
protokollen. 
Koden skal innehalda entity for mottaker som vist i Figur 5.  Koden skal som minimum 
handtera meldingar med 8 bit, ingen paritet.  
Det er tillat Ã¥ laga kode som kan konfigurerast med 5-8 bit pr melding og med eller utan 
paritet, ved hjelp av generics eller kontrollsignal 
4. Baud-rate-generator for sendar 
a. Generator for ein fast baud-rate 
b. Konfigurerbar baud-rate, som i Tabell 1 
5. Baud-rate-generator for mottakar 
a. Generator for ein fast baud-rate 
b. Konfigurerbar baud-rate, som i Tabell 1 
 
Kode for sendar og mottakar kan godt kombinerast i eit

--- Page 10 ---
ELE111 SemesteroppgÃ¥ve 
  10 
Quartus-prosjekt, der kortet blir konfigurert som sendar eller 
mottakar med SW-brytar. 
6. Data-kjelder i sendar 
a. Melding, 8 bit, hardkoda i VHDL-koden for sendar. 
b. Melding, 8 bit gitt med  SWo-7 
c. Lag digital klokke pÃ¥ sendar, send 3 byte klokke-data til mottakar. 
d. 3 byte med klokkedata, med synkronisering pÃ¥ byte-nivÃ¥.  
7. Visining av data i mottakar 
a. LED 
b. 7-segment-display 
c. LCD-skjerm 
8. Verifikasjon 
Sendar og mottakar bÃ¸r verifiserast. Detta kan gjerast med Modelsim eller SignalTap, helst begge 
to. 
a. Modelsim 
b. SignalTap 
 
9. Test 
NÃ¥r systemet er ferdig mÃ¥ det testast pÃ¥ kortet.   
a. Mot seg sjÃ¸lv, med loop mellom sendar og mottakar pÃ¥ EX_IO-kontakten 
b. Mot anna DE2-115-kort 
10. Synkronisering  
a. Klokkene (CLOCK_50) pÃ¥ sendar og mottakar er ikkje synkroniserte. Det 
betyr at vi har klokke-domene-kryssing mellom sendar og mottakar, og 
data inn pÃ¥ mottakar mÃ¥ synkroniserast. 
b. Reset (frÃ¥ KEY(3)) mÃ¥ synkroniserast til klokka. 
c. Ved sending av fleire data-byte mÃ¥ mottakaren kunne fastslÃ¥ kva byte 
som er fÃ¸rst i ein sekvens. Det bÃ¸r lagast ein mekanisme som mottakaren 
kan bruka for Ã¥ kunne presentera data i rett rekkefÃ¸lge.

